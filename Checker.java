import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;
import java.io.IOException;
import java.util.ArrayList;

public class Checker {
  public static void mainScan(String link) throws IOException {    
	String website = link;
    Document doc = Jsoup.connect(link).get();
    Elements files = doc.select("td.content");
    
    for (Element src : files) {
    	System.out.println("src is " + src.text());
    	if (!src.text().equals("Failed to load latest commit information.")) {
    		String web = website + "/" + src.text();
    		System.out.println("web is " + web);
        	websiteScan(web);
        	System.out.println();
        	System.out.println();
        	System.out.println();
        	System.out.println();
        	System.out.println();
    	}
    }
  }
  public static void websiteScan(String website) throws IOException {
	  String document = website;
	  Document doc = Jsoup.connect(document).get();
	  Elements file = doc.select("td.js-file-line");
	  
	  ArrayList<String> text = new ArrayList<String>();
	  
	  for (Element src : file) {
		  text.add(src.text());
	  }

	  for (int i = 0; i < text.size(); i++) {
		  System.out.println(text.get(i));
	  }
  }
  public static void main(String[] args) throws IOException {
    // list everything System.getProperties().list(System.out);
    // declares variables and prints to check
    String operatingSystem = System.getProperty("os.name");
    String cpu = System.getProperty("sun.cpu.isalist");
    String link = "";
    System.out.println(operatingSystem);
    System.out.println(cpu);
    
    if (operatingSystem.toLowerCase().contains("mac")) {
      link = "https://github.com/offensive-security/exploit-database/tree/master/exploits/macos";
    }
    else if (cpu.toLowerCase().equals("amd64")) {
      if (operatingSystem.toLowerCase().contains("windows")) {
        link = "https://github.com/offensive-security/exploit-database/tree/master/exploits/windows_x86-64/local";
      }
      else if (operatingSystem.contains("linux")) {
        link = "https://github.com/offensive-security/exploit-database/tree/master/exploits/linux_x86-64";
      }
    }
    else if (operatingSystem.toLowerCase().equals("amd32")) { // whatever 32bit is
      if (operatingSystem.toLowerCase().equals("windows")) {
        link = "https://github.com/offensive-security/exploit-database/tree/master/exploits/windows_x86";
      }
      else if (operatingSystem.toLowerCase().equals("linux")) {
        link = "https://github.com/offensive-security/exploit-database/tree/master/exploits/linux_x86";
      }
    }
    mainScan(link);
  }
}
